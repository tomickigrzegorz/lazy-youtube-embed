{"version":3,"file":"youtubeLazy.esm.js","sources":["../../sources/js/utils/function.ts","../../sources/js/index.ts"],"sourcesContent":["/**\r\n * @param type - set div, a, span, button, etc.\r\n * @param name - class name\r\n * @returns\r\n */\r\nconst addClass = (type: string, name: string) => {\r\n  const element = document.createElement(type);\r\n  element.className = name;\r\n  return element;\r\n};\r\n\r\n/**\r\n * @param el - element html\r\n * @param attrs - attributes\r\n */\r\nconst setAttr = (el: HTMLElement, attrs: any) => {\r\n  for (var key in attrs) {\r\n    el.setAttribute(key, attrs[key]);\r\n  }\r\n};\r\n\r\n/**\r\n * @param object - object\r\n */\r\nconst parseJson = (object: any) => JSON.parse(object);\r\n\r\n/**\r\n * @param id - id video\r\n * @param link - link to video\r\n */\r\nconst createIFrame = (id: string, link: string) => {\r\n  const iframe = addClass('iframe', '');\r\n  setAttr(iframe, {\r\n    frameborder: '0',\r\n    allowfullscreen: 'true',\r\n    allow:\r\n      'accelerometer;autoplay;encrypted-media;gyroscope;picture-in-picture;',\r\n    src: `${link}/embed/${id}?autoplay=1`,\r\n  });\r\n\r\n  return iframe;\r\n};\r\n\r\n/**\r\n * @returns red button\r\n */\r\nconst createRedButton = () => {\r\n  const buttonW = addClass('div', 'ytLazy__thumbnail');\r\n  const buttonS = addClass('div', 'ytLazy__img ytLazy__img--svg');\r\n\r\n  buttonW.appendChild(buttonS);\r\n  return buttonW;\r\n};\r\n\r\nexport { addClass, setAttr, parseJson, createIFrame, createRedButton };\r\n","import {\r\n  addClass,\r\n  setAttr,\r\n  parseJson,\r\n  createIFrame,\r\n  createRedButton,\r\n} from './utils/function';\r\n\r\nexport default class ytLazy {\r\n  private class: string;\r\n  private background?: string;\r\n  private opacity?: number;\r\n  private overflow?: boolean;\r\n  private overLayer: HTMLElement;\r\n  private maxWidth?: number | null;\r\n  private createWatchIn?: Function;\r\n  private link: string;\r\n\r\n  constructor(\r\n    classElement: string,\r\n    {\r\n      background = '#000',\r\n      opacity = 80,\r\n      maxWidth = 90,\r\n      overflow = false,\r\n      createWatchIn = () => {},\r\n    }: ConstructorObject\r\n  ) {\r\n    this.class = classElement;\r\n    this.background = background;\r\n    this.opacity = opacity;\r\n    this.overflow = overflow;\r\n    this.maxWidth = maxWidth;\r\n    this.createWatchIn = createWatchIn;\r\n    this.link = 'https://www.youtube.com';\r\n\r\n    this.overLayer = addClass('div', 'ytLight');\r\n    const overLayer = this.overLayer;\r\n    document.body.appendChild(overLayer);\r\n\r\n    this.initial();\r\n  }\r\n\r\n  initial = () => {\r\n    const getYTLazy = document.querySelectorAll(`.${this.class}`);\r\n\r\n    for (let i = 0; i < getYTLazy.length; i++) {\r\n      const { id, openIn } = parseJson(getYTLazy[i].getAttribute('data-yt'));\r\n\r\n      setAttr(<HTMLElement>getYTLazy[i], {\r\n        style: `background-image:url('//i.ytimg.com/vi/${id}/sddefault.jpg');`,\r\n      });\r\n\r\n      getYTLazy[i].appendChild(createRedButton());\r\n\r\n      if (openIn && this.createWatchIn) {\r\n        this.createWatchIn({\r\n          link: this.link + '/watch?v=' + id,\r\n          template: (template: string) => {\r\n            getYTLazy[i].insertAdjacentHTML('beforeend', template);\r\n          },\r\n        });\r\n      }\r\n    }\r\n\r\n    this.handEvent();\r\n  };\r\n\r\n  hex2rgb = (hex: string = '#000', opacity = 10) => {\r\n    const c =\r\n      typeof hex === 'string' ? parseInt(hex.replace('#', ''), 16) : hex;\r\n    return `rgba(${c >> 16},${(c & 0xff00) >> 8},${c & 0xff},${opacity / 100})`;\r\n  };\r\n\r\n  setLbox = (target: HTMLElement) => {\r\n    const watchIn = target.closest('.ytLazy__watch-in-link');\r\n    if (watchIn) return;\r\n\r\n    const element = target.closest('.ytLazy__item');\r\n\r\n    if (element === null || element.className !== this.class) return;\r\n\r\n    const { id, local, maxWidth } = parseJson(element.getAttribute('data-yt'));\r\n    if (local) {\r\n      const frame = createIFrame(id, this.link);\r\n      setAttr(frame, {\r\n        width: '100%',\r\n        height: '100%',\r\n      });\r\n\r\n      element.innerHTML = '';\r\n      element.appendChild(frame);\r\n\r\n      return;\r\n    } else {\r\n      this.lightbox({ id, maxWidth });\r\n    }\r\n  };\r\n\r\n  closeLbox = () => {\r\n    const isOpen = document.querySelector('.is-open');\r\n    if (isOpen === null) return;\r\n    isOpen.innerHTML = '';\r\n    isOpen.classList.remove('is-open');\r\n    if (this.overflow) {\r\n      document.body.classList.remove('ytLight-active');\r\n    }\r\n  };\r\n\r\n  handClick = (event: Event) => {\r\n    event.stopPropagation();\r\n    const { target } = event;\r\n\r\n    this.closeLbox();\r\n    this.setLbox(<HTMLElement>target);\r\n  };\r\n\r\n  handKey = (event: KeyboardEvent) => {\r\n    if (event.key !== 'Escape') return;\r\n    this.setLbox(<HTMLElement>event.target);\r\n    this.closeLbox();\r\n  };\r\n\r\n  handEvent = () => {\r\n    window.addEventListener('click', this.handClick);\r\n    window.addEventListener('keydown', this.handKey);\r\n  };\r\n\r\n  lightbox = ({ id, maxWidth }: { id: string; maxWidth: string }) => {\r\n    if (this.overflow) {\r\n      document.body.classList.add('ytLight-active');\r\n    }\r\n\r\n    const button = addClass('button', 'ytLight-close');\r\n    setAttr(button, {\r\n      type: 'button',\r\n      title: 'close movie',\r\n    });\r\n\r\n    const wrap = addClass('div', 'ytLight-wrap');\r\n    const container = addClass('div', 'ytLight-container');\r\n\r\n    (this.maxWidth || maxWidth) &&\r\n      setAttr(container, {\r\n        style: `max-width: ${maxWidth || this.maxWidth}%`,\r\n      });\r\n\r\n    const iframCointainer = addClass('div', 'ytLight-iframe');\r\n\r\n    iframCointainer.appendChild(createIFrame(id, this.link));\r\n    container.appendChild(iframCointainer);\r\n    wrap.appendChild(container);\r\n\r\n    iframCointainer.insertAdjacentElement('afterend', button);\r\n\r\n    const overlay = this.overLayer;\r\n    overlay.appendChild(wrap);\r\n    overlay.classList.add('is-open');\r\n    overlay.setAttribute(\r\n      'style',\r\n      `background:${this.hex2rgb(this.background, this.opacity)}`\r\n    );\r\n  };\r\n}\r\n"],"names":[],"mappings":"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"}