!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):(t="undefined"!=typeof globalThis?globalThis:t||self).ytLazy=i()}(this,(function(){"use strict";const t=(t,i)=>{const e=document.createElement(t);return e.className=i,e},i=(t,i)=>{for(var e in i)t.setAttribute(e,i[e])},e=t=>JSON.parse(t),s=(e,s)=>{const n=t("iframe","");return i(n,{frameborder:"0",allowfullscreen:"true",allow:"accelerometer;autoplay;encrypted-media;gyroscope;picture-in-picture;",src:`${s}/embed/${e}?autoplay=1`}),n},n=()=>{const i=t("div","ytLazy__thumbnail"),e=t("div","ytLazy__img ytLazy__img--svg");return i.appendChild(e),i};return class{constructor(h,{background:o="rgba(0,0,0,0.9)",maxWidth:c=90,overflow:a=!1,picture:d=!1,createWatchIn:r=(()=>{})}){this.t=()=>{const t=document.querySelectorAll("."+this.i);for(let i=0;i<t.length;i++){const{id:s,openIn:h,title:o,picture:c}=e(t[i].getAttribute("data-yt"));if(t[i].appendChild(this.s(s,c)),t[i].appendChild(n()),null!=o&&o){const e=`<div class="ytLazy__title">${o}</div><div class="ytLazy__gradient-top"></div>`;t[i].insertAdjacentHTML("beforeend",e)}h&&this.h&&this.h({link:this.o+"/watch?v="+s,template:e=>{t[i].insertAdjacentHTML("beforeend",e)}})}this.u()},this.s=(t,i)=>{const e=[{media:"(min-width: 1440px)",srcset:this.l(t,"maxresdefault")},{media:"(min-width: 1024px)",srcset:this.l(t,"hqdefault")},{media:"(min-width: 480px)",srcset:this.l(t,"mqdefault")}],s=this.m("picture");e.map(t=>{s.appendChild(this.m("source",t))});const n=new Image;return n.className="ytLazy__image",n.loading="lazy",n.width=1050,n.height=787,n.src=this.l(t,"sddefault"),s.appendChild(n),this.p||i?s:n},this.l=(t,i)=>`//i.ytimg.com/vi/${t}/${i}.jpg`,this.m=(t,e)=>{const s=document.createElement(t);return e&&i(s,e),s},this.g=t=>{if(t.closest(".ytLazy__watch-in-link"))return;const n=t.closest(".ytLazy__item");if(null===n||n.className!==this.i)return;const{id:h,local:o,maxWidth:c}=e(n.getAttribute("data-yt"));if(o){const t=s(h,this.o);return i(t,{width:"100%",height:"100%"}),n.innerHTML="",void n.appendChild(t)}this.v({id:h,maxWidth:c})},this.L=()=>{const t=document.querySelector(".ytLazy-is-open");t&&(t.innerHTML="",t.classList.remove("ytLazy-is-open"),this._&&document.body.classList.remove("ytLight-active"))},this.$=t=>{t.stopPropagation();const{target:i}=t;this.L(),this.g(i)},this.k=t=>{"Escape"===t.key&&(this.g(t.target),this.L())},this.u=()=>{window.addEventListener("click",this.$),window.addEventListener("keydown",this.k)},this.v=({id:e,maxWidth:n})=>{this._&&document.body.classList.add("ytLight-active");const h=t("button","ytLight-close");i(h,{type:"button",title:"close movie"});const o=t("div","ytLight-wrap"),c=t("div","ytLight-container");(this.W||n)&&i(c,{style:`max-width: ${n||this.W}%`});const a=t("div","ytLight-iframe");a.appendChild(s(e,this.o)),c.appendChild(a),o.appendChild(c),a.insertAdjacentElement("afterend",h),this.I.appendChild(o),this.I.classList.add("ytLazy-is-open"),this.I.setAttribute("style",`background:${this.j};`)},this.i=h,this.j=o,this._=a,this.p=d,this.W=c,this.h=r,this.o="https://www.youtube.com",this.I=t("div","ytLight"),document.body.appendChild(this.I),this.t()}}}));
