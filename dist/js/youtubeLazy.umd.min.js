!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):(t="undefined"!=typeof globalThis?globalThis:t||self).ytLazy=i()}(this,(function(){"use strict";const t=(t,i)=>{const e=document.createElement(t);return e.className=i,e},i=(t,i)=>{for(var e in i)t.setAttribute(e,i[e])},e=t=>JSON.parse(t),s=(e,s)=>{const n=t("iframe","");return i(n,{frameborder:"0",allowfullscreen:"true",allow:"accelerometer;autoplay;encrypted-media;gyroscope;picture-in-picture;",src:`${s}/embed/${e}?autoplay=1`}),n},n=()=>{const i=t("div","ytLazy__thumbnail"),e=t("div","ytLazy__img ytLazy__img--svg");return i.appendChild(e),i};return class{constructor(o,{background:h="rgba(0,0,0,0.9)",maxWidth:a=90,overflow:c=!1,createWatchIn:d=(()=>{})}){this.t=()=>{const t=document.querySelectorAll("."+this.i);for(let i=0;i<t.length;i++){const{id:s,openIn:o,title:h}=e(t[i].getAttribute("data-yt"));if(t[i].appendChild(this.s(s)),t[i].appendChild(n()),null!=h&&h){const e=`<div class="ytLazy__title">${h}</div><div class="ytLazy__gradient-top"></div>`;t[i].insertAdjacentHTML("beforeend",e)}o&&this.o&&this.o({link:this.h+"/watch?v="+s,template:e=>{t[i].insertAdjacentHTML("beforeend",e)}})}this.l()},this.s=t=>{const i=new Image;return i.className="ytLazy__image",i.loading="lazy",i.src=`//i.ytimg.com/vi/${t}/sddefault.jpg`,i},this.u=t=>{if(t.closest(".ytLazy__watch-in-link"))return;const n=t.closest(".ytLazy__item");if(null===n||n.className!==this.i)return;const{id:o,local:h,maxWidth:a}=e(n.getAttribute("data-yt"));if(h){const t=s(o,this.h);return i(t,{width:"100%",height:"100%"}),n.innerHTML="",void n.appendChild(t)}this.m({id:o,maxWidth:a})},this.g=()=>{const t=document.querySelector(".ytLazy-is-open");t&&(t.innerHTML="",t.classList.remove("ytLazy-is-open"),this.p&&document.body.classList.remove("ytLight-active"))},this.v=t=>{t.stopPropagation();const{target:i}=t;this.g(),this.u(i)},this.L=t=>{"Escape"===t.key&&(this.u(t.target),this.g())},this.l=()=>{window.addEventListener("click",this.v),window.addEventListener("keydown",this.L)},this.m=({id:e,maxWidth:n})=>{this.p&&document.body.classList.add("ytLight-active");const o=t("button","ytLight-close");i(o,{type:"button",title:"close movie"});const h=t("div","ytLight-wrap"),a=t("div","ytLight-container");(this._||n)&&i(a,{style:`max-width: ${n||this._}%`});const c=t("div","ytLight-iframe");c.appendChild(s(e,this.h)),a.appendChild(c),h.appendChild(a),c.insertAdjacentElement("afterend",o),this.k.appendChild(h),this.k.classList.add("ytLazy-is-open"),this.k.setAttribute("style",`background:${this.$};`)},this.i=o,this.$=h,this.p=c,this._=a,this.o=d,this.h="https://www.youtube.com",this.k=t("div","ytLight"),document.body.appendChild(this.k),this.t()}}}));
