!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):(t="undefined"!=typeof globalThis?globalThis:t||self).ytLazy=i()}(this,(function(){"use strict";const t=(t,e)=>{const s=document.createElement(t);return e&&i(s,"string"==typeof e?{class:e}:e),s},i=(t,i)=>{for(var e in i)t.setAttribute(e,i[e])},e=t=>JSON.parse(t),s=(t,i=300)=>{let e;return function(...s){clearTimeout(e),e=setTimeout((()=>t.apply(this,s)),i)}};return class{constructor(h,{background:n="rgba(0,0,0,0.9)",maxWidth:o=90,overflow:a=!1,local:c=!0,picture:d=!1,onResize:r=(()=>{}),createWatchIn:l=(()=>{})}){this.t=()=>{const i=document.querySelectorAll(`.${this.i}`);for(let s=0;s<i.length;s++){const{id:h,openIn:n,title:o,picture:a}=e(i[s].getAttribute("data-yt"));if(i[s].appendChild(this.h(h,a)),i[s].appendChild(t("div","ytLazy__img--svg")),null!=o&&o){const e=t("div","ytLazy__title");e.textContent=o,i[s].insertAdjacentElement("beforeend",e),e.insertAdjacentElement("afterend",t("div","ytLazy__gradient-top"))}n&&this.o&&this.o({index:s,link:this.l+"/watch?v="+h,template:t=>{i[s].insertAdjacentHTML("beforeend",t)}})}this.u()},this.h=(i,e)=>{const s=[{media:"(min-width: 1440px)",srcset:this.m(i,"maxresdefault")},{media:"(min-width: 1024px)",srcset:this.m(i,"hqdefault")},{media:"(min-width: 480px)",srcset:this.m(i,"mqdefault")}],h=t("picture");s.map((i=>{h.appendChild(t("source",i))}));const n=new Image;return n.className="ytLazy__image",n.loading="lazy",n.width=1050,n.height=787,n.src=this.m(i,"sddefault"),h.appendChild(n),this.p||e?h:n},this.m=(t,i)=>`//i.ytimg.com/vi/${t}/${i}.jpg`,this.g=s=>{if(s.closest(".ytLazy__watch-in-link"))return;const h=s.closest(".ytLazy__item");if(null===h||!h.classList.contains(this.i))return;const{id:n,local:o,maxWidth:a}=e(h.getAttribute("data-yt"));if(null!=o?o:this.L){const e=t("iframe",this.v(n,this.l));return i(e,{width:"100%",height:"100%"}),h.textContent="",void h.appendChild(e)}this._({id:n,maxWidth:a})},this.$=()=>{const t=document.querySelector(".ytLazy-is-open");t&&(t.textContent="",t.classList.remove("ytLazy-is-open"),this.k&&document.body.classList.remove("ytLight-active"))},this.W=t=>{t.stopPropagation();const{target:i}=t;this.$(),this.g(i)},this.T=t=>{"Escape"===t.key&&(this.g(t.target),this.$())},this.u=()=>{window.addEventListener("click",this.W),window.addEventListener("keydown",this.T),window.addEventListener("DOMContentLoaded",(()=>this.L=this.I())),window.addEventListener("resize",s((()=>this.L=this.I()),70))},this.v=(t,i)=>({frameborder:"0",allowfullscreen:"true",allow:"accelerometer;autoplay;encrypted-media;gyroscope;picture-in-picture;",src:`${i}/embed/${t}?autoplay=1`}),this._=({id:e,maxWidth:s})=>{this.k&&document.body.classList.add("ytLight-active");const h=t("button","ytLight-close");i(h,{type:"button",title:"close movie"});const n=t("div","ytLight-wrap"),o=t("div","ytLight-container");(this.j||s)&&i(o,{style:`max-width: ${s||this.j}%`});const a=t("div","ytLight-iframe");a.appendChild(t("iframe",this.v(e,this.l))),o.appendChild(a),n.appendChild(o),a.insertAdjacentElement("afterend",h),this.q.appendChild(n),this.q.classList.add("ytLazy-is-open"),this.q.setAttribute("style",`background:${this.O};`)},this.i=h,this.O=n,this.L=c,this.k=a,this.p=d,this.j=o,this.o=l,this.I=r,this.l="https://www.youtube.com",this.q=t("div","ytLight"),document.body.appendChild(this.q),this.t()}}}));
