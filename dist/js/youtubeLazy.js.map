{"version":3,"file":"youtubeLazy.js","sources":["../../sources/js/utils/function.ts","../../sources/js/index.ts"],"sourcesContent":["/**\r\n * @param type - set div, a, span, button, etc.\r\n * @param name - class name\r\n * @returns\r\n */\r\nconst addClass = (type: string, name: string) => {\r\n  const element = document.createElement(type);\r\n  element.className = name;\r\n  return element;\r\n};\r\n\r\n/**\r\n * @param el - element html\r\n * @param attrs - attributes\r\n */\r\nconst setAttribute = (el: HTMLElement, attrs: any) => {\r\n  for (var key in attrs) {\r\n    el.setAttribute(key, attrs[key]);\r\n  }\r\n};\r\n\r\n/**\r\n * @param object - object\r\n */\r\nconst parseJson = (object: any) => JSON.parse(object);\r\n\r\n/**\r\n * @param id - id video\r\n * @param link - link to video\r\n */\r\nconst createIFrame = (id: string, link: string) => {\r\n  const iframe = addClass(\"iframe\", \"\");\r\n  setAttribute(iframe, {\r\n    frameborder: \"0\",\r\n    allowfullscreen: \"true\",\r\n    allow:\r\n      \"accelerometer;autoplay;encrypted-media;gyroscope;picture-in-picture;\",\r\n    src: `${link}/embed/${id}?autoplay=1`,\r\n  });\r\n\r\n  return iframe;\r\n};\r\n\r\n/**\r\n * @returns red button\r\n */\r\nconst createRedButton = () => {\r\n  const buttonW = addClass(\"div\", \"ytLazy__thumbnail\");\r\n  const buttonS = addClass(\"div\", \"ytLazy__img ytLazy__img--svg\");\r\n\r\n  buttonW.appendChild(buttonS);\r\n  return buttonW;\r\n};\r\n\r\nexport { addClass, setAttribute, parseJson, createIFrame, createRedButton };\r\n","import {\r\n  addClass,\r\n  setAttribute,\r\n  parseJson,\r\n  createIFrame,\r\n  createRedButton,\r\n} from \"./utils/function\";\r\n\r\nexport default class ytLazy {\r\n  private _class: string;\r\n  private _background?: string;\r\n  private _overflow?: boolean;\r\n  private _overLayer: HTMLElement;\r\n  private _maxWidth?: number | null;\r\n  private _createWatchIn?: Function;\r\n  private _link: string;\r\n\r\n  constructor(\r\n    classElement: string,\r\n    {\r\n      background = \"rgba(0,0,0,0.9)\",\r\n      maxWidth = 90,\r\n      overflow = false,\r\n      createWatchIn = () => {},\r\n    }: ConstructorObject\r\n  ) {\r\n    this._class = classElement;\r\n    this._background = background;\r\n    this._overflow = overflow;\r\n    this._maxWidth = maxWidth;\r\n    this._createWatchIn = createWatchIn;\r\n    this._link = \"https://www.youtube.com\";\r\n\r\n    this._overLayer = addClass(\"div\", \"ytLight\");\r\n    document.body.appendChild(this._overLayer);\r\n\r\n    this._initial();\r\n  }\r\n\r\n  _initial = () => {\r\n    const getYTLazy = document.querySelectorAll(`.${this._class}`);\r\n\r\n    for (let i = 0; i < getYTLazy.length; i++) {\r\n      const { id, openIn, title } = parseJson(\r\n        getYTLazy[i].getAttribute(\"data-yt\")\r\n      );\r\n\r\n      // add image\r\n      <HTMLElement>getYTLazy[i].appendChild(this._createImage(id));\r\n\r\n      // add red button\r\n      getYTLazy[i].appendChild(createRedButton());\r\n\r\n      if (title ?? false) {\r\n        const titleElement = `<div class=\"ytLazy__title\">${title}</div><div class=\"ytLazy__gradient-top\"></div>`;\r\n        getYTLazy[i].insertAdjacentHTML(\"beforeend\", titleElement);\r\n      }\r\n\r\n      if (openIn && this._createWatchIn) {\r\n        this._createWatchIn({\r\n          link: this._link + \"/watch?v=\" + id,\r\n          template: (template: string) => {\r\n            getYTLazy[i].insertAdjacentHTML(\"beforeend\", template);\r\n          },\r\n        });\r\n      }\r\n    }\r\n\r\n    this._handEvent();\r\n  };\r\n\r\n  /**\r\n   *\r\n   * @param id - id video\r\n   * @returns {HTMLImageElement}\r\n   */\r\n  _createImage = (id: string): HTMLImageElement => {\r\n    const image = new Image();\r\n    image.className = \"ytLazy__image\";\r\n    image.loading = \"lazy\";\r\n    image.src = `//i.ytimg.com/vi/${id}/sddefault.jpg`;\r\n    return image;\r\n  };\r\n\r\n  /**\r\n   *\r\n   * @param target - target element\r\n   */\r\n  _setLightbox = (target: HTMLElement) => {\r\n    const watchIn = target.closest(\".ytLazy__watch-in-link\");\r\n    if (watchIn) return;\r\n\r\n    const element = target.closest(\".ytLazy__item\");\r\n\r\n    if (element === null || element.className !== this._class) return;\r\n\r\n    const { id, local, maxWidth } = parseJson(element.getAttribute(\"data-yt\"));\r\n    if (local) {\r\n      const frame = createIFrame(id, this._link);\r\n      setAttribute(frame, {\r\n        width: \"100%\",\r\n        height: \"100%\",\r\n      });\r\n\r\n      element.innerHTML = \"\";\r\n      element.appendChild(frame);\r\n\r\n      return;\r\n    } else {\r\n      this._lightbox({ id, maxWidth });\r\n    }\r\n  };\r\n\r\n  // close lightbox\r\n  _closeLightbox = () => {\r\n    const isOpen = document.querySelector(\".ytLazy-is-open\");\r\n    if (!isOpen) return;\r\n    isOpen.innerHTML = \"\";\r\n    isOpen.classList.remove(\"ytLazy-is-open\");\r\n    this._overflow && document.body.classList.remove(\"ytLight-active\");\r\n  };\r\n\r\n  _handClick = (event: Event) => {\r\n    event.stopPropagation();\r\n    const { target } = event;\r\n\r\n    this._closeLightbox();\r\n    this._setLightbox(<HTMLElement>target);\r\n  };\r\n\r\n  _handKey = (event: KeyboardEvent) => {\r\n    if (event.key !== \"Escape\") return;\r\n    this._setLightbox(<HTMLElement>event.target);\r\n    this._closeLightbox();\r\n  };\r\n\r\n  _handEvent = () => {\r\n    window.addEventListener(\"click\", this._handClick);\r\n    window.addEventListener(\"keydown\", this._handKey);\r\n  };\r\n\r\n  _lightbox = ({ id, maxWidth }: { id: string; maxWidth: string }) => {\r\n    if (this._overflow) {\r\n      document.body.classList.add(\"ytLight-active\");\r\n    }\r\n\r\n    const button = addClass(\"button\", \"ytLight-close\");\r\n    setAttribute(button, {\r\n      type: \"button\",\r\n      title: \"close movie\",\r\n    });\r\n\r\n    const wrap = addClass(\"div\", \"ytLight-wrap\");\r\n    const container = addClass(\"div\", \"ytLight-container\");\r\n\r\n    (this._maxWidth || maxWidth) &&\r\n      setAttribute(container, {\r\n        style: `max-width: ${maxWidth || this._maxWidth}%`,\r\n      });\r\n\r\n    const iframCointainer = addClass(\"div\", \"ytLight-iframe\");\r\n\r\n    iframCointainer.appendChild(createIFrame(id, this._link));\r\n    container.appendChild(iframCointainer);\r\n    wrap.appendChild(container);\r\n\r\n    iframCointainer.insertAdjacentElement(\"afterend\", button);\r\n\r\n    this._overLayer.appendChild(wrap);\r\n    this._overLayer.classList.add(\"ytLazy-is-open\");\r\n    this._overLayer.setAttribute(\"style\", `background:${this._background};`);\r\n  };\r\n}\r\n"],"names":[],"mappings":"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"}