{"version":3,"file":"youtubeLazy.min.js","sources":["../../sources/js/utils/function.ts","../../sources/js/index.ts"],"sourcesContent":["/**\r\n * @param type - set div, a, span, button, etc.\r\n * @param name - class name\r\n * @returns\r\n */\r\nconst addClass = (type: string, name: string) => {\r\n  const element = document.createElement(type);\r\n  element.className = name;\r\n  return element;\r\n};\r\n\r\n/**\r\n * @param el - element html\r\n * @param attrs - attributes\r\n */\r\nconst setAttribute = (el: HTMLElement, attrs: any) => {\r\n  for (var key in attrs) {\r\n    el.setAttribute(key, attrs[key]);\r\n  }\r\n};\r\n\r\n/**\r\n * @param object - object\r\n */\r\nconst parseJson = (object: any) => JSON.parse(object);\r\n\r\n/**\r\n * @param id - id video\r\n * @param link - link to video\r\n */\r\nconst createIFrame = (id: string, link: string) => {\r\n  const iframe = addClass(\"iframe\", \"\");\r\n  setAttribute(iframe, {\r\n    frameborder: \"0\",\r\n    allowfullscreen: \"true\",\r\n    allow:\r\n      \"accelerometer;autoplay;encrypted-media;gyroscope;picture-in-picture;\",\r\n    src: `${link}/embed/${id}?autoplay=1`,\r\n  });\r\n\r\n  return iframe;\r\n};\r\n\r\n/**\r\n * @returns red button\r\n */\r\nconst createRedButton = () => {\r\n  const buttonW = addClass(\"div\", \"ytLazy__thumbnail\");\r\n  const buttonS = addClass(\"div\", \"ytLazy__img ytLazy__img--svg\");\r\n\r\n  buttonW.appendChild(buttonS);\r\n  return buttonW;\r\n};\r\n\r\nexport { addClass, setAttribute, parseJson, createIFrame, createRedButton };\r\n","import {\r\n  addClass,\r\n  setAttribute,\r\n  parseJson,\r\n  createIFrame,\r\n  createRedButton,\r\n} from \"./utils/function\";\r\n\r\nexport default class ytLazy {\r\n  private _class: string;\r\n  private _background?: string;\r\n  private _picture?: boolean;\r\n  private _overflow?: boolean;\r\n  private _overLayer: HTMLElement;\r\n  private _maxWidth?: number | null;\r\n  private _link: string;\r\n  private _createWatchIn?: Function;\r\n\r\n  constructor(\r\n    classElement: string,\r\n    {\r\n      background = \"rgba(0,0,0,0.9)\",\r\n      maxWidth = 90,\r\n      overflow = false,\r\n      picture = false,\r\n      createWatchIn = () => {},\r\n    }: ConstructorObject\r\n  ) {\r\n    this._class = classElement;\r\n    this._background = background;\r\n    this._overflow = overflow;\r\n    this._picture = picture;\r\n    this._maxWidth = maxWidth;\r\n    this._createWatchIn = createWatchIn;\r\n    this._link = \"https://www.youtube.com\";\r\n\r\n    this._overLayer = addClass(\"div\", \"ytLight\");\r\n    document.body.appendChild(this._overLayer);\r\n\r\n    this._initial();\r\n  }\r\n\r\n  _initial = () => {\r\n    const getYTLazy = document.querySelectorAll(`.${this._class}`);\r\n\r\n    for (let i = 0; i < getYTLazy.length; i++) {\r\n      const { id, openIn, title, picture } = parseJson(\r\n        getYTLazy[i].getAttribute(\"data-yt\")\r\n      );\r\n\r\n      // add image\r\n      getYTLazy[i].appendChild(this._createImage(id, picture));\r\n\r\n      // add red button\r\n      getYTLazy[i].appendChild(createRedButton());\r\n\r\n      if (title ?? false) {\r\n        const titleElement = `<div class=\"ytLazy__title\">${title}</div><div class=\"ytLazy__gradient-top\"></div>`;\r\n        getYTLazy[i].insertAdjacentHTML(\"beforeend\", titleElement);\r\n      }\r\n\r\n      if (openIn && this._createWatchIn) {\r\n        this._createWatchIn({\r\n          link: this._link + \"/watch?v=\" + id,\r\n          template: (template: string) => {\r\n            getYTLazy[i].insertAdjacentHTML(\"beforeend\", template);\r\n          },\r\n        });\r\n      }\r\n    }\r\n\r\n    this._handEvent();\r\n  };\r\n\r\n  /**\r\n   * Create image or picture width image\r\n   *\r\n   * @param id - id video\r\n   * @returns {HTMLImageElement}\r\n   */\r\n  _createImage = (id: string, pic: string | null): any => {\r\n    const sourcesArray: ConfigObject[] = [\r\n      {\r\n        media: \"(min-width: 1440px)\",\r\n        srcset: this._sourceURL(id, \"maxresdefault\"),\r\n      },\r\n      {\r\n        media: \"(min-width: 1024px)\",\r\n        srcset: this._sourceURL(id, \"hqdefault\"),\r\n      },\r\n      {\r\n        media: \"(min-width: 480px)\",\r\n        srcset: this._sourceURL(id, \"mqdefault\"),\r\n      },\r\n    ];\r\n\r\n    const picture = this._createElement(\"picture\");\r\n    sourcesArray.map((element: ConfigObject) => {\r\n      picture.appendChild(this._createElement(\"source\", element));\r\n    });\r\n\r\n    const image = new Image();\r\n    image.className = \"ytLazy__image\";\r\n    image.loading = \"lazy\";\r\n    image.width = 1050;\r\n    image.height = 787;\r\n    image.src = this._sourceURL(id, \"sddefault\");\r\n\r\n    picture.appendChild(image);\r\n\r\n    return this._picture || pic ? picture : image;\r\n  };\r\n\r\n  /**\r\n   * Image url\r\n   *\r\n   * @param id - movie\r\n   * @param type - image size\r\n   * @returns {HTMLImageElement}\r\n   */\r\n  _sourceURL = (id: string, type: string): string => {\r\n    return `//i.ytimg.com/vi/${id}/${type}.jpg`;\r\n  };\r\n\r\n  /**\r\n   * Create picure or source element\r\n   *\r\n   * @param el - type of element\r\n   * @param config - config element\r\n   * @returns {HTMLImageElement}\r\n   */\r\n  _createElement = (el: string, config?: ConfigObject): HTMLElement => {\r\n    const element = document.createElement(el);\r\n    if (config) {\r\n      setAttribute(element, config);\r\n    }\r\n    return element;\r\n  };\r\n\r\n  /**\r\n   *\r\n   * @param target - target element\r\n   */\r\n  _setLightbox = (target: HTMLElement) => {\r\n    const watchIn = target.closest(\".ytLazy__watch-in-link\");\r\n    if (watchIn) return;\r\n\r\n    const element = target.closest(\".ytLazy__item\");\r\n\r\n    if (element === null || element.className !== this._class) return;\r\n\r\n    const { id, local, maxWidth } = parseJson(element.getAttribute(\"data-yt\"));\r\n    if (local) {\r\n      const frame = createIFrame(id, this._link);\r\n      setAttribute(frame, {\r\n        width: \"100%\",\r\n        height: \"100%\",\r\n      });\r\n\r\n      element.innerHTML = \"\";\r\n      element.appendChild(frame);\r\n\r\n      return;\r\n    } else {\r\n      this._lightbox({ id, maxWidth });\r\n    }\r\n  };\r\n\r\n  // close lightbox\r\n  _closeLightbox = () => {\r\n    const isOpen = document.querySelector(\".ytLazy-is-open\");\r\n    if (!isOpen) return;\r\n    isOpen.innerHTML = \"\";\r\n    isOpen.classList.remove(\"ytLazy-is-open\");\r\n    this._overflow && document.body.classList.remove(\"ytLight-active\");\r\n  };\r\n\r\n  _handClick = (event: Event) => {\r\n    event.stopPropagation();\r\n    const { target } = event;\r\n\r\n    this._closeLightbox();\r\n    this._setLightbox(<HTMLElement>target);\r\n  };\r\n\r\n  _handKey = (event: KeyboardEvent) => {\r\n    if (event.key !== \"Escape\") return;\r\n    this._setLightbox(<HTMLElement>event.target);\r\n    this._closeLightbox();\r\n  };\r\n\r\n  _handEvent = () => {\r\n    window.addEventListener(\"click\", this._handClick);\r\n    window.addEventListener(\"keydown\", this._handKey);\r\n  };\r\n\r\n  _lightbox = ({ id, maxWidth }: { id: string; maxWidth: string }) => {\r\n    if (this._overflow) {\r\n      document.body.classList.add(\"ytLight-active\");\r\n    }\r\n\r\n    const button = addClass(\"button\", \"ytLight-close\");\r\n    setAttribute(button, {\r\n      type: \"button\",\r\n      title: \"close movie\",\r\n    });\r\n\r\n    const wrap = addClass(\"div\", \"ytLight-wrap\");\r\n    const container = addClass(\"div\", \"ytLight-container\");\r\n\r\n    (this._maxWidth || maxWidth) &&\r\n      setAttribute(container, {\r\n        style: `max-width: ${maxWidth || this._maxWidth}%`,\r\n      });\r\n\r\n    const iframCointainer = addClass(\"div\", \"ytLight-iframe\");\r\n\r\n    iframCointainer.appendChild(createIFrame(id, this._link));\r\n    container.appendChild(iframCointainer);\r\n    wrap.appendChild(container);\r\n\r\n    iframCointainer.insertAdjacentElement(\"afterend\", button);\r\n\r\n    this._overLayer.appendChild(wrap);\r\n    this._overLayer.classList.add(\"ytLazy-is-open\");\r\n    this._overLayer.setAttribute(\"style\", `background:${this._background};`);\r\n  };\r\n}\r\n"],"names":["addClass","type","name","element","document","createElement","className","setAttribute","el","attrs","key","parseJson","object","JSON","parse","createIFrame","id","link","iframe","frameborder","allowfullscreen","allow","src","createRedButton","buttonW","buttonS","appendChild","[object Object]","classElement","background","maxWidth","overflow","picture","createWatchIn","this","getYTLazy","querySelectorAll","_class","i","length","openIn","title","getAttribute","_createImage","titleElement","insertAdjacentHTML","_createWatchIn","_link","template","_handEvent","pic","sourcesArray","media","srcset","_sourceURL","_createElement","map","image","Image","loading","width","height","_picture","config","target","closest","local","frame","innerHTML","_lightbox","isOpen","querySelector","classList","remove","_overflow","body","event","stopPropagation","_closeLightbox","_setLightbox","window","addEventListener","_handClick","_handKey","add","button","wrap","container","_maxWidth","style","iframCointainer","insertAdjacentElement","_overLayer","_background","_initial"],"mappings":"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"}