{"version":3,"file":"youtubeLazy.min.js","sources":["../../sources/js/utils/function.ts","../../sources/js/index.ts"],"sourcesContent":["/**\r\n * @param type - set div, a, span, button, etc.\r\n * @param name - class name\r\n * @returns\r\n */\r\nconst addClass = (type: string, name: string) => {\r\n  const element = document.createElement(type);\r\n  element.className = name;\r\n  return element;\r\n};\r\n\r\n/**\r\n * @param el - element html\r\n * @param attrs - attributes\r\n */\r\nconst setAttribute = (el: HTMLElement, attrs: any) => {\r\n  for (var key in attrs) {\r\n    el.setAttribute(key, attrs[key]);\r\n  }\r\n};\r\n\r\n/**\r\n * @param object - object\r\n */\r\nconst parseJson = (object: any) => JSON.parse(object);\r\n\r\n/**\r\n * @param id - id video\r\n * @param link - link to video\r\n */\r\nconst createIFrame = (id: string, link: string) => {\r\n  const iframe = addClass(\"iframe\", \"\");\r\n  setAttribute(iframe, {\r\n    frameborder: \"0\",\r\n    allowfullscreen: \"true\",\r\n    allow:\r\n      \"accelerometer;autoplay;encrypted-media;gyroscope;picture-in-picture;\",\r\n    src: `${link}/embed/${id}?autoplay=1`,\r\n  });\r\n\r\n  return iframe;\r\n};\r\n\r\n/**\r\n * @returns red button\r\n */\r\nconst createRedButton = () => {\r\n  const buttonW = addClass(\"div\", \"ytLazy__thumbnail\");\r\n  const buttonS = addClass(\"div\", \"ytLazy__img ytLazy__img--svg\");\r\n\r\n  buttonW.appendChild(buttonS);\r\n  return buttonW;\r\n};\r\n\r\nexport { addClass, setAttribute, parseJson, createIFrame, createRedButton };\r\n","import {\r\n  addClass,\r\n  setAttribute,\r\n  parseJson,\r\n  createIFrame,\r\n  createRedButton,\r\n} from \"./utils/function\";\r\n\r\nexport default class ytLazy {\r\n  private _class: string;\r\n  private _background?: string;\r\n  private _overflow?: boolean;\r\n  private _overLayer: HTMLElement;\r\n  private _maxWidth?: number | null;\r\n  private _createWatchIn?: Function;\r\n  private _link: string;\r\n\r\n  constructor(\r\n    classElement: string,\r\n    {\r\n      background = \"rgba(0,0,0,0.9)\",\r\n      maxWidth = 90,\r\n      overflow = false,\r\n      createWatchIn = () => {},\r\n    }: ConstructorObject\r\n  ) {\r\n    this._class = classElement;\r\n    this._background = background;\r\n    this._overflow = overflow;\r\n    this._maxWidth = maxWidth;\r\n    this._createWatchIn = createWatchIn;\r\n    this._link = \"https://www.youtube.com\";\r\n\r\n    this._overLayer = addClass(\"div\", \"ytLight\");\r\n    document.body.appendChild(this._overLayer);\r\n\r\n    this._initial();\r\n  }\r\n\r\n  _initial = () => {\r\n    const getYTLazy = document.querySelectorAll(`.${this._class}`);\r\n\r\n    for (let i = 0; i < getYTLazy.length; i++) {\r\n      const { id, openIn, title } = parseJson(\r\n        getYTLazy[i].getAttribute(\"data-yt\")\r\n      );\r\n\r\n      // add image\r\n      <HTMLElement>getYTLazy[i].appendChild(this._createImage(id));\r\n\r\n      // add red button\r\n      getYTLazy[i].appendChild(createRedButton());\r\n\r\n      if (title ?? false) {\r\n        const titleElement = `<div class=\"ytLazy__title\">${title}</div><div class=\"ytLazy__gradient-top\"></div>`;\r\n        getYTLazy[i].insertAdjacentHTML(\"beforeend\", titleElement);\r\n      }\r\n\r\n      if (openIn && this._createWatchIn) {\r\n        this._createWatchIn({\r\n          link: this._link + \"/watch?v=\" + id,\r\n          template: (template: string) => {\r\n            getYTLazy[i].insertAdjacentHTML(\"beforeend\", template);\r\n          },\r\n        });\r\n      }\r\n    }\r\n\r\n    this._handEvent();\r\n  };\r\n\r\n  /**\r\n   *\r\n   * @param id - id video\r\n   * @returns {HTMLImageElement}\r\n   */\r\n  _createImage = (id: string): HTMLImageElement => {\r\n    const image = new Image();\r\n    image.className = \"ytLazy__image\";\r\n    image.loading = \"lazy\";\r\n    image.src = `//i.ytimg.com/vi/${id}/sddefault.jpg`;\r\n    return image;\r\n  };\r\n\r\n  /**\r\n   *\r\n   * @param target - target element\r\n   */\r\n  _setLightbox = (target: HTMLElement) => {\r\n    const watchIn = target.closest(\".ytLazy__watch-in-link\");\r\n    if (watchIn) return;\r\n\r\n    const element = target.closest(\".ytLazy__item\");\r\n\r\n    if (element === null || element.className !== this._class) return;\r\n\r\n    const { id, local, maxWidth } = parseJson(element.getAttribute(\"data-yt\"));\r\n    if (local) {\r\n      const frame = createIFrame(id, this._link);\r\n      setAttribute(frame, {\r\n        width: \"100%\",\r\n        height: \"100%\",\r\n      });\r\n\r\n      element.innerHTML = \"\";\r\n      element.appendChild(frame);\r\n\r\n      return;\r\n    } else {\r\n      this._lightbox({ id, maxWidth });\r\n    }\r\n  };\r\n\r\n  // close lightbox\r\n  _closeLightbox = () => {\r\n    const isOpen = document.querySelector(\".ytLazy-is-open\");\r\n    if (!isOpen) return;\r\n    isOpen.innerHTML = \"\";\r\n    isOpen.classList.remove(\"ytLazy-is-open\");\r\n    this._overflow && document.body.classList.remove(\"ytLight-active\");\r\n  };\r\n\r\n  _handClick = (event: Event) => {\r\n    event.stopPropagation();\r\n    const { target } = event;\r\n\r\n    this._closeLightbox();\r\n    this._setLightbox(<HTMLElement>target);\r\n  };\r\n\r\n  _handKey = (event: KeyboardEvent) => {\r\n    if (event.key !== \"Escape\") return;\r\n    this._setLightbox(<HTMLElement>event.target);\r\n    this._closeLightbox();\r\n  };\r\n\r\n  _handEvent = () => {\r\n    window.addEventListener(\"click\", this._handClick);\r\n    window.addEventListener(\"keydown\", this._handKey);\r\n  };\r\n\r\n  _lightbox = ({ id, maxWidth }: { id: string; maxWidth: string }) => {\r\n    if (this._overflow) {\r\n      document.body.classList.add(\"ytLight-active\");\r\n    }\r\n\r\n    const button = addClass(\"button\", \"ytLight-close\");\r\n    setAttribute(button, {\r\n      type: \"button\",\r\n      title: \"close movie\",\r\n    });\r\n\r\n    const wrap = addClass(\"div\", \"ytLight-wrap\");\r\n    const container = addClass(\"div\", \"ytLight-container\");\r\n\r\n    (this._maxWidth || maxWidth) &&\r\n      setAttribute(container, {\r\n        style: `max-width: ${maxWidth || this._maxWidth}%`,\r\n      });\r\n\r\n    const iframCointainer = addClass(\"div\", \"ytLight-iframe\");\r\n\r\n    iframCointainer.appendChild(createIFrame(id, this._link));\r\n    container.appendChild(iframCointainer);\r\n    wrap.appendChild(container);\r\n\r\n    iframCointainer.insertAdjacentElement(\"afterend\", button);\r\n\r\n    this._overLayer.appendChild(wrap);\r\n    this._overLayer.classList.add(\"ytLazy-is-open\");\r\n    this._overLayer.setAttribute(\"style\", `background:${this._background};`);\r\n  };\r\n}\r\n"],"names":["addClass","type","name","element","document","createElement","className","setAttribute","el","attrs","key","parseJson","object","JSON","parse","createIFrame","id","link","iframe","frameborder","allowfullscreen","allow","src","createRedButton","buttonW","buttonS","appendChild","[object Object]","classElement","background","maxWidth","overflow","createWatchIn","this","getYTLazy","querySelectorAll","_class","i","length","openIn","title","getAttribute","_createImage","titleElement","insertAdjacentHTML","_createWatchIn","_link","template","_handEvent","image","Image","loading","target","closest","local","frame","width","height","innerHTML","_lightbox","isOpen","querySelector","classList","remove","_overflow","body","event","stopPropagation","_closeLightbox","_setLightbox","window","addEventListener","_handClick","_handKey","add","button","wrap","container","_maxWidth","style","iframCointainer","insertAdjacentElement","_overLayer","_background","_initial"],"mappings":"mCAKA,MAAMA,EAAW,CAACC,EAAcC,KAC9B,MAAMC,EAAUC,SAASC,cAAcJ,GAEvC,OADAE,EAAQG,UAAYJ,EACbC,GAOHI,EAAe,CAACC,EAAiBC,KACrC,IAAK,IAAIC,KAAOD,EACdD,EAAGD,aAAaG,EAAKD,EAAMC,KAOzBC,EAAaC,GAAgBC,KAAKC,MAAMF,GAMxCG,EAAe,CAACC,EAAYC,KAChC,MAAMC,EAASlB,EAAS,SAAU,IASlC,OARAO,EAAaW,EAAQ,CACnBC,YAAa,IACbC,gBAAiB,OACjBC,MACE,uEACFC,IAAK,GAAGL,WAAcD,iBAGjBE,GAMHK,EAAkB,KACtB,MAAMC,EAAUxB,EAAS,MAAO,qBAC1ByB,EAAUzB,EAAS,MAAO,gCAGhC,OADAwB,EAAQE,YAAYD,GACbD,gBClCPG,YACEC,GACAC,WACEA,EAAa,kBAAiBC,SAC9BA,EAAW,GAAEC,SACbA,GAAW,EAAKC,cAChBA,EAAgB,WAgBpBC,OAAW,KACT,MAAMC,EAAY9B,SAAS+B,iBAAiB,IAAIF,KAAKG,GAErD,IAAK,IAAIC,EAAI,EAAGA,EAAIH,EAAUI,OAAQD,IAAK,CACzC,MAAMrB,GAAEA,EAAEuB,OAAEA,EAAMC,MAAEA,GAAU7B,EAC5BuB,EAAUG,GAAGI,aAAa,YAS5B,GALaP,EAAUG,GAAGX,YAAYO,KAAKS,EAAa1B,IAGxDkB,EAAUG,GAAGX,YAAYH,KAErBiB,MAAAA,GAAAA,EAAgB,CAClB,MAAMG,EAAe,8BAA8BH,kDACnDN,EAAUG,GAAGO,mBAAmB,YAAaD,GAG3CJ,GAAUN,KAAKY,GACjBZ,KAAKY,EAAe,CAClB5B,KAAMgB,KAAKa,EAAQ,YAAc9B,EACjC+B,SAAWA,IACTb,EAAUG,GAAGO,mBAAmB,YAAaG,MAMrDd,KAAKe,KAQPf,OAAgBjB,IACd,MAAMiC,EAAQ,IAAIC,MAIlB,OAHAD,EAAM3C,UAAY,gBAClB2C,EAAME,QAAU,OAChBF,EAAM3B,IAAM,oBAAoBN,kBACzBiC,GAOThB,OAAgBmB,IAEd,GADgBA,EAAOC,QAAQ,0BAClB,OAEb,MAAMlD,EAAUiD,EAAOC,QAAQ,iBAE/B,GAAgB,OAAZlD,GAAoBA,EAAQG,YAAc2B,KAAKG,EAAQ,OAE3D,MAAMpB,GAAEA,EAAEsC,MAAEA,EAAKxB,SAAEA,GAAanB,EAAUR,EAAQsC,aAAa,YAC/D,GAAIa,EAAO,CACT,MAAMC,EAAQxC,EAAaC,EAAIiB,KAAKa,GASpC,OARAvC,EAAagD,EAAO,CAClBC,MAAO,OACPC,OAAQ,SAGVtD,EAAQuD,UAAY,QACpBvD,EAAQuB,YAAY6B,GAIpBtB,KAAK0B,EAAU,CAAE3C,GAAAA,EAAIc,SAAAA,KAKzBG,OAAiB,KACf,MAAM2B,EAASxD,SAASyD,cAAc,mBACjCD,IACLA,EAAOF,UAAY,GACnBE,EAAOE,UAAUC,OAAO,kBACxB9B,KAAK+B,GAAa5D,SAAS6D,KAAKH,UAAUC,OAAO,oBAGnD9B,OAAciC,IACZA,EAAMC,kBACN,MAAMf,OAAEA,GAAWc,EAEnBjC,KAAKmC,IACLnC,KAAKoC,EAA0BjB,IAGjCnB,OAAYiC,IACQ,WAAdA,EAAMxD,MACVuB,KAAKoC,EAA0BH,EAAMd,QACrCnB,KAAKmC,MAGPnC,OAAa,KACXqC,OAAOC,iBAAiB,QAAStC,KAAKuC,GACtCF,OAAOC,iBAAiB,UAAWtC,KAAKwC,IAG1CxC,OAAY,EAAGjB,GAAAA,EAAIc,SAAAA,MACbG,KAAK+B,GACP5D,SAAS6D,KAAKH,UAAUY,IAAI,kBAG9B,MAAMC,EAAS3E,EAAS,SAAU,iBAClCO,EAAaoE,EAAQ,CACnB1E,KAAM,SACNuC,MAAO,gBAGT,MAAMoC,EAAO5E,EAAS,MAAO,gBACvB6E,EAAY7E,EAAS,MAAO,sBAEjCiC,KAAK6C,GAAahD,IACjBvB,EAAasE,EAAW,CACtBE,MAAO,cAAcjD,GAAYG,KAAK6C,OAG1C,MAAME,EAAkBhF,EAAS,MAAO,kBAExCgF,EAAgBtD,YAAYX,EAAaC,EAAIiB,KAAKa,IAClD+B,EAAUnD,YAAYsD,GACtBJ,EAAKlD,YAAYmD,GAEjBG,EAAgBC,sBAAsB,WAAYN,GAElD1C,KAAKiD,EAAWxD,YAAYkD,GAC5B3C,KAAKiD,EAAWpB,UAAUY,IAAI,kBAC9BzC,KAAKiD,EAAW3E,aAAa,QAAS,cAAc0B,KAAKkD,OAhJzDlD,KAAKG,EAASR,EACdK,KAAKkD,EAActD,EACnBI,KAAK+B,EAAYjC,EACjBE,KAAK6C,EAAYhD,EACjBG,KAAKY,EAAiBb,EACtBC,KAAKa,EAAQ,0BAEbb,KAAKiD,EAAalF,EAAS,MAAO,WAClCI,SAAS6D,KAAKvC,YAAYO,KAAKiD,GAE/BjD,KAAKmD"}