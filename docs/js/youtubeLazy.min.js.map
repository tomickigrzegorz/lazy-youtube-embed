{"version":3,"file":"youtubeLazy.min.js","sources":["../../sources/js/utils/function.ts","../../sources/js/index.ts"],"sourcesContent":["/**\r\n * @param type - set div, a, span, button, etc.\r\n * @param name - class name\r\n * @returns\r\n */\r\nconst addClass = (type: string, name: string) => {\r\n  const element = document.createElement(type);\r\n  element.className = name;\r\n  return element;\r\n};\r\n\r\n/**\r\n * @param el - element html\r\n * @param attrs - attributes\r\n */\r\nconst setAttr = (el: HTMLElement, attrs: any) => {\r\n  for (var key in attrs) {\r\n    el.setAttribute(key, attrs[key]);\r\n  }\r\n};\r\n\r\n/**\r\n * @param object - object\r\n */\r\nconst parseJson = (object: any) => JSON.parse(object);\r\n\r\n/**\r\n * @param id - id video\r\n * @param link - link to video\r\n */\r\nconst createIFrame = (id: string, link: string) => {\r\n  const iframe = addClass('iframe', '');\r\n  setAttr(iframe, {\r\n    frameborder: '0',\r\n    allowfullscreen: 'true',\r\n    allow:\r\n      'accelerometer;autoplay;encrypted-media;gyroscope;picture-in-picture;',\r\n    src: `${link}/embed/${id}?autoplay=1`,\r\n  });\r\n\r\n  return iframe;\r\n};\r\n\r\n/**\r\n * @returns red button\r\n */\r\nconst createRedButton = () => {\r\n  const buttonW = addClass('div', 'ytLazy__thumbnail');\r\n  const buttonS = addClass('div', 'ytLazy__img ytLazy__img--svg');\r\n\r\n  buttonW.appendChild(buttonS);\r\n  return buttonW;\r\n};\r\n\r\nexport { addClass, setAttr, parseJson, createIFrame, createRedButton };\r\n","import {\r\n  addClass,\r\n  setAttr,\r\n  parseJson,\r\n  createIFrame,\r\n  createRedButton,\r\n} from './utils/function';\r\n\r\nexport default class ytLazy {\r\n  private class: string;\r\n  private background?: string;\r\n  private opacity?: number;\r\n  private overflow?: boolean;\r\n  private overLayer: HTMLElement;\r\n  private maxWidth?: number | null;\r\n  private createWatchIn?: Function;\r\n  private link: string;\r\n\r\n  constructor(\r\n    classElement: string,\r\n    {\r\n      background = '#000',\r\n      opacity = 80,\r\n      maxWidth = 90,\r\n      overflow = false,\r\n      createWatchIn = () => {},\r\n    }: ConstructorObject\r\n  ) {\r\n    this.class = classElement;\r\n    this.background = background;\r\n    this.opacity = opacity;\r\n    this.overflow = overflow;\r\n    this.maxWidth = maxWidth;\r\n    this.createWatchIn = createWatchIn;\r\n    this.link = 'https://www.youtube.com';\r\n\r\n    this.overLayer = addClass('div', 'ytLight');\r\n    const overLayer = this.overLayer;\r\n    document.body.appendChild(overLayer);\r\n\r\n    this.initial();\r\n  }\r\n\r\n  initial = () => {\r\n    const getYTLazy = document.querySelectorAll(`.${this.class}`);\r\n\r\n    for (let i = 0; i < getYTLazy.length; i++) {\r\n      const { id, openIn } = parseJson(getYTLazy[i].getAttribute('data-yt'));\r\n\r\n      setAttr(<HTMLElement>getYTLazy[i], {\r\n        style: `background-image:url('//i.ytimg.com/vi/${id}/sddefault.jpg');`,\r\n      });\r\n\r\n      getYTLazy[i].appendChild(createRedButton());\r\n\r\n      if (openIn && this.createWatchIn) {\r\n        this.createWatchIn({\r\n          link: this.link + '/watch?v=' + id,\r\n          template: (template: string) => {\r\n            getYTLazy[i].insertAdjacentHTML('beforeend', template);\r\n          },\r\n        });\r\n      }\r\n    }\r\n\r\n    this.handEvent();\r\n  };\r\n\r\n  hex2rgb = (hex: string = '#000', opacity = 10) => {\r\n    const c =\r\n      typeof hex === 'string' ? parseInt(hex.replace('#', ''), 16) : hex;\r\n    return `rgba(${c >> 16},${(c & 0xff00) >> 8},${c & 0xff},${opacity / 100})`;\r\n  };\r\n\r\n  setLbox = (target: HTMLElement) => {\r\n    const watchIn = target.closest('.ytLazy__watch-in-link');\r\n    if (watchIn) return;\r\n\r\n    const element = target.closest('.ytLazy__item');\r\n\r\n    if (element === null || element.className !== this.class) return;\r\n\r\n    const { id, local, maxWidth } = parseJson(element.getAttribute('data-yt'));\r\n    if (local) {\r\n      const frame = createIFrame(id, this.link);\r\n      setAttr(frame, {\r\n        width: '100%',\r\n        height: '100%',\r\n      });\r\n\r\n      element.innerHTML = '';\r\n      element.appendChild(frame);\r\n\r\n      return;\r\n    } else {\r\n      this.lightbox({ id, maxWidth });\r\n    }\r\n  };\r\n\r\n  closeLbox = () => {\r\n    const isOpen = document.querySelector('.is-open');\r\n    if (isOpen === null) return;\r\n    isOpen.innerHTML = '';\r\n    isOpen.classList.remove('is-open');\r\n    if (this.overflow) {\r\n      document.body.classList.remove('ytLight-active');\r\n    }\r\n  };\r\n\r\n  handClick = (event: Event) => {\r\n    event.stopPropagation();\r\n    const { target } = event;\r\n\r\n    this.closeLbox();\r\n    this.setLbox(<HTMLElement>target);\r\n  };\r\n\r\n  handKey = (event: KeyboardEvent) => {\r\n    if (event.key !== 'Escape') return;\r\n    this.setLbox(<HTMLElement>event.target);\r\n    this.closeLbox();\r\n  };\r\n\r\n  handEvent = () => {\r\n    window.addEventListener('click', this.handClick);\r\n    window.addEventListener('keydown', this.handKey);\r\n  };\r\n\r\n  lightbox = ({ id, maxWidth }: { id: string; maxWidth: string }) => {\r\n    if (this.overflow) {\r\n      document.body.classList.add('ytLight-active');\r\n    }\r\n\r\n    const button = addClass('button', 'ytLight-close');\r\n    setAttr(button, {\r\n      type: 'button',\r\n      title: 'close movie',\r\n    });\r\n\r\n    const wrap = addClass('div', 'ytLight-wrap');\r\n    const container = addClass('div', 'ytLight-container');\r\n\r\n    (this.maxWidth || maxWidth) &&\r\n      setAttr(container, {\r\n        style: `max-width: ${maxWidth || this.maxWidth}%`,\r\n      });\r\n\r\n    const iframCointainer = addClass('div', 'ytLight-iframe');\r\n\r\n    iframCointainer.appendChild(createIFrame(id, this.link));\r\n    container.appendChild(iframCointainer);\r\n    wrap.appendChild(container);\r\n\r\n    iframCointainer.insertAdjacentElement('afterend', button);\r\n\r\n    const overlay = this.overLayer;\r\n    overlay.appendChild(wrap);\r\n    overlay.classList.add('is-open');\r\n    overlay.setAttribute(\r\n      'style',\r\n      `background:${this.hex2rgb(this.background, this.opacity)}`\r\n    );\r\n  };\r\n}\r\n"],"names":["addClass","type","name","element","document","createElement","className","setAttr","el","attrs","key","setAttribute","parseJson","object","JSON","parse","createIFrame","id","link","iframe","frameborder","allowfullscreen","allow","src","classElement","_a","_b","background","_c","opacity","_d","maxWidth","_e","overflow","_f","createWatchIn","this","getYTLazy","querySelectorAll","_this","class","i","buttonW","buttonS","getAttribute","openIn","style","appendChild","template","insertAdjacentHTML","length","handEvent","hex","c","parseInt","replace","target","closest","local","frame","width","height","innerHTML","lightbox","isOpen","querySelector","classList","remove","body","event","stopPropagation","closeLbox","setLbox","window","addEventListener","handClick","handKey","add","button","title","wrap","container","iframCointainer","insertAdjacentElement","overlay","overLayer","hex2rgb","initial"],"mappings":"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"}